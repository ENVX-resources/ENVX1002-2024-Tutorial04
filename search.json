[
  {
    "objectID": "Tutorial_04.html",
    "href": "Tutorial_04.html",
    "title": "ENVX1002 Tutorial 4",
    "section": "",
    "text": "Learning outcomes\n\n\n\nAt the end of this computer practical, students should be able to:\n\ncalculate tail, interval and inverse probabilities associated with the Normal distribution\ncalculate probabilities associated sampling distribution of the sample mean by using simulation in R and using R commands.\nUnderstand how simulation links to the central limit theorem."
  },
  {
    "objectID": "Tutorial_04.html#example-1---rainfall",
    "href": "Tutorial_04.html#example-1---rainfall",
    "title": "ENVX1002 Tutorial 4",
    "section": "Example 1 - Rainfall",
    "text": "Example 1 - Rainfall\n\nSummary statistics and histogram\nI have downloaded the daily rainfall at Sydney’s Botanical Gardens from 1970-2021.\nhttp://www.bom.gov.au/climate/data/\nWe are going to do some calculations on the total annual rainfall. To do this we are going to us the dplyr package to calculate the total annual rainfall from daily rainfall first. Then we will calculate:\n\nmean\nstandard deviation\nhistogram\n\n\nlibrary(readxl)\nrain &lt;- read_excel(\"data/ENVX1002_Topic4.xlsx\", sheet = \"Sydney_rain\")\n\n\n## Calculate total annual rain using dplyr\nlibrary(dplyr)\nannual_rain &lt;- rain %&gt;%\n  group_by(Year) %&gt;%\n  summarise(Annual_rain = sum(Precip_mm))\n\n\nmean_rain &lt;- round(mean(annual_rain$Annual_rain), 0)\nmean_rain\n\n[1] 1254\n\nsd_rain &lt;- round(sd(annual_rain$Annual_rain), 0)\nsd_rain\n\n[1] 298\n\n\n\nOur mean is 1254 mm\nOur standard deviation is 298mm\n\n\nlibrary(ggplot2)\nggplot(annual_rain, aes(Annual_rain)) +\n  geom_histogram(bins = 6)\n\n\n\n\n\n\n\n\nOur distribution looks to be fairly symmetrical albeit a little right skewed. Later in the course you will learn to test if a dataset is normal, we will assume this dataset is. Therefore we can say that\nX = Annual.rainfall \\sim N(1254, 298^2)\n\n\nProbability calculations\nSay we are interested in really dry periods in Sydney as these may result in spikes in water demand. So we want to determine what is the probability that annual Sydney rainfall is less than 600 mm as this may be a threshold to trigger water restrictions?\nWe want to calculate P(X &lt; 600), we can plot this as follows\n\nggplot(data.frame(x = c(1254-4*298, 1254+4*298)), aes(x = x)) +\n  stat_function(fun = dnorm, args = list(mean = 1254, sd = 298), \n                geom = \"area\", fill = \"red\") +\n  stat_function(fun = dnorm, args = list(mean = 1254, sd=298), \n                xlim = c(1254-4*298, 600), geom = \"area\", \n                fill = \"white\") +\n  xlab(\"x\") +\n  ylab(expression(N(1254,298^2)~pdf)) +\n  scale_x_continuous(breaks = 600)\n\n\n\n\n\n\n\n\nTo calculate the probability we can use pnorm\n\npnorm(600, 1254, 298)\n\n[1] 0.01409504\n\n\nSo there is a 1.4% chance that less then 600mm of rain will fall in anyone year.\nWe can also standardise the variable and calculate the probability for the standard normal curve (or the standard normal tables in the old days https://en.wikipedia.org/wiki/Standard_normal_table)\nP(X&lt;600)=P(\\frac{X-1254}{298}&lt;\\frac{600-1254}{298}) =P(Z&lt;-2.194631)\n\npnorm(-2.194631)\n\n[1] 0.01409504\n\n\nNOTE: To plot P(X&gt;600) we can make some slight modifications by changing the sign in xlim = c(1254-4*298, 600) to a +\n\nggplot(data.frame(x = c(1254-4*298, 1254+4*298)), aes(x = x)) +\n  stat_function(fun = dnorm, args = list(mean = 1254, sd = 298), \n                geom = \"area\", fill = \"red\") +\n  stat_function(fun = dnorm, args = list(mean = 1254, sd=298), \n                xlim = c(1254+4*298, 600), geom = \"area\", \n                fill = \"white\") +\n  xlab(\"x\") +\n  ylab(expression(N(1254,298^2)~pdf)) +\n  scale_x_continuous(breaks = 600)\n\n\n\n\n\n\n\n\n\n\nInverse probability calculations\nWhat is the 95% percentile of rainfall?\nFirst we need to calculate the value of x at the 95th percentile\n\nqnorm(0.95, 1254, 298)\n\n[1] 1744.166\n\n\nTherefore, 95% of annual total rainfall values are less than 1744.166 mm of rain i.e. 5% of the time we can expect more than 1744.166 mm of rain.\n\nggplot(data.frame(x = c(1254-4*298, 1254+4*298)), aes(x = x)) +\n  stat_function(fun = dnorm, args = list(mean = 1254, sd = 298), \n                geom = \"area\", fill = \"red\") +\n  stat_function(fun = dnorm, args = list(mean = 1254, sd=298), \n                xlim = c(1254-4*298, 1744.166), geom = \"area\", \n                fill = \"white\") +\n  xlab(\"x\") +\n  ylab(expression(N(1254,298^2)~pdf)) +\n  scale_x_continuous(breaks = 1744.166)"
  },
  {
    "objectID": "Tutorial_04.html#example---simulation-of-the-central-limit-theorem",
    "href": "Tutorial_04.html#example---simulation-of-the-central-limit-theorem",
    "title": "ENVX1002 Tutorial 4",
    "section": "Example - simulation of the central limit theorem",
    "text": "Example - simulation of the central limit theorem\nOlson and Miller reported the inter-orbital widths (in mm), distance between the eyes, of domestic pigeons in their 1958 book, Morphological Integration.\nThe following is a subset of the inter-orbital width (mm) of 40 domestic pigeons and the measurements are are as follows\n\nIOW &lt;- data.frame(width = c(12.2, 12.9, 11.8, 11.9, 11.6, 11.1, 12.3, 12.2, 11.8, 11.8, 10.7, 11.5, 11.3, 11.2, 11.6, 11.9, 14.3, 13.2, 10.5, 11.1, 12.5, 11.1, 10.4, 10.7, 10.8, 11.0, 11.1, 10.2, 10.9, 11.6, 10.8, 11.9, 10.4, 10.7, 12.0, 12.9, 13.7, 11.8, 11.3, 11.1))\n\nThe mean and standard deviation of the inter-orbital width are as follows:\n\nmean(IOW$width)\n\n[1] 11.595\n\nsd(IOW$width)\n\n[1] 0.9122949\n\n\nWe can use the ggplot2 package to plot a histogram of the inter-orbital width:\n\nggplot(IOW, aes(width))+\n  geom_histogram(bins = 10)\n\n\n\n\n\n\n\n\nWe can use the sample function to simulate the sampling distribution of the sample mean. We will take 5 samples of the inter-orbital width and calculate the sample mean. We will repeat this 10, 100, 1000 and 10000 times and plot the sampling distribution of the sample mean.\n\n10\n\nset.seed(1)\nsample_means &lt;- data.frame(Sample_mean = vector(length = 10))\nfor(i in 1:10){\n        sample_means$Sample_mean[i] &lt;- mean(sample(IOW$width, 5, replace = TRUE))\n}\nggplot(sample_means, aes(Sample_mean))+\n  geom_histogram() + \n  xlab(\"Sample mean\")\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\nmean(sample_means$Sample_mean)\n\n[1] 11.552\n\n\n\n\n100\n\nset.seed(1)\nsample_means &lt;- data.frame(Sample_mean = vector(length = 100))\nfor(i in 1:100){\n        sample_means$Sample_mean[i] &lt;- mean(sample(IOW$width, 5, replace = TRUE))\n}\nggplot(sample_means, aes(Sample_mean))+\n  geom_histogram() + \n  xlab(\"Sample mean\")\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\nmean(sample_means$Sample_mean)\n\n[1] 11.581\n\n\n\n\n1000\n\n\n\n\nset.seed(1)\nsample_means &lt;- data.frame(Sample_mean = vector(length = 1000))\nfor(i in 1:1000){\n        sample_means$Sample_mean[i] &lt;- mean(sample(IOW$width, 5, replace = TRUE))\n}\nggplot(sample_means, aes(Sample_mean))+\n  geom_histogram() + \n  xlab(\"Sample mean\")\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\nmean(sample_means$Sample_mean)\n\n[1] 11.57442\n\n\n\n\n10000\n\nset.seed(1)\nsample_means &lt;- data.frame(Sample_mean = vector(length = 10000))\nfor(i in 1:10000){\n        sample_means$Sample_mean[i] &lt;- mean(sample(IOW$width, 5, replace = TRUE))\n}\nggplot(sample_means, aes(Sample_mean))+\n  geom_histogram() + \n  xlab(\"Sample mean\")\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\n\nmean(sample_means$Sample_mean)\n\n[1] 11.59095"
  },
  {
    "objectID": "Tutorial_04.html#example-3---past-exam-question",
    "href": "Tutorial_04.html#example-3---past-exam-question",
    "title": "ENVX1002 Tutorial 4",
    "section": "Example 3 - Past exam question",
    "text": "Example 3 - Past exam question\nInterorbital widths (in mm) of 5 domestic pigeons are as follows: 12.2 12.9 11.8 11.9 11.2\n\nObtain the sample mean and sample standard deviation of the widths.\nCalculate the standard error of the mean. Interpret this briefly but carefully, highlighting the difference in interpretation between the standard deviation and the standard error of the mean.\n\n\n-Sample mean:\n\\overline{x}=\\frac{12.2+12.9+11.8+11.9+11.2}{5}=12mm\n\nSample sd:\n\ns=\\sqrt{\\frac{1}{n-1}\\sum_{i=1}^{5}(x_i-\\overline{x})^2} =\\sqrt{\\frac{1}{5-1}((12.2-12)^2+(12.9-12)^2+...+(11.2-12)^2)} =0.62mm\nUsing R\n\npigeon &lt;- c(12.2,12.9,11.8,11.9,11.2)\npigeon_mean &lt;- mean(pigeon)\npigeon_mean\n\n[1] 12\n\npigeon_sd &lt;- sd(pigeon)\npigeon_sd\n\n[1] 0.6204837\n\n\n\nThe standard error of the mean\n\nse(\\overline{X})=\\frac{s}{\\sqrt{n}}=\\frac{0.62}{\\sqrt{5}}\\approx0.28mm\nBy r:\n\npigeon_sem &lt;-pigeon_sd/sqrt(length(pigeon)) ## length(pigeon) gives you n\npigeon_sem\n\n[1] 0.2774887\n\n\nThe standard error (se) gives an estimate of how uncertain we are about the sample mean - it is effectively the standard deviation sd of the sample mean. The difference between sd and se is that sd describes the amount of variation in the sample being studied and the se describes the uncertainty in the estimate of the mean."
  }
]